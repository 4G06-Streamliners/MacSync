\documentclass[12pt, titlepage]{article}

\usepackage{amsmath, mathtools}

\usepackage[round]{natbib}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{colortbl}
\usepackage{xr}
\usepackage{hyperref}
\usepackage{longtable}
\usepackage{xfrac}
\usepackage{tabularx}
\usepackage{float}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage{caption}
\usepackage{fullpage}

\hypersetup{
bookmarks=true,     % show bookmarks bar?
colorlinks=true,       % false: boxed links; true: colored links
linkcolor=red,          % color of internal links (change box color with linkbordercolor)
citecolor=blue,      % color of links to bibliography
filecolor=magenta,  % color of file links
urlcolor=cyan          % color of external links
}

\usepackage{array}

\externaldocument{../../SRS/SRS}

\input{../../Comments}
\input{../../Common}

\begin{document}

\title{Module Interface Specification for \progname{}}

\author{\authname}

\date{\today}

\maketitle

\pagenumbering{roman}

\section{Revision History}

\begin{tabularx}{\textwidth}{p{3cm}p{2cm}X}
\toprule {\bf Date} & {\bf Version} & {\bf Notes}\\
\midrule
Date 1 & 1.0 & Notes\\
Date 2 & 1.1 & Notes\\
\bottomrule
\end{tabularx}

~\newpage

\section{Symbols, Abbreviations and Acronyms}

See SRS Documentation at \href{https://github.com/4G06-Streamliners/MacSync-SRS/blob/main/index.pdf}{SRS} and MG Documentation at \href{https://github.com/4G06-Streamliners/MacSync/blob/main/docs/Design/SoftArchitecture/MG.pdf}{MG}.

\newpage

\tableofcontents

\newpage

\pagenumbering{arabic}

\section{Introduction}

The following document details the Module Interface Specification for the Large Event Management System (LEMS).
It defines the detailed interfaces, inputs, outputs, and dependencies among the software modules that comprise the
system. Building on the design decomposition outlined in the Module Guide and the functional and non-functional
requirements in the Software Requirements Specification (SRS), this document establishes a precise contract for how
each module communicates and interacts within the overall architecture.\\

\noindent
The LEMS platform is a centralized event management solution developed for the McMaster Engineering Society (MES)
to support the organization and execution of large-scale student events such as the Fireball Formal, Graduation
Formal, and Pub Nights. The system integrates event registration, ticketing, waivers, payment processing, and
check-in into a single platform accessible via web and mobile interfaces. To ensure modularity, maintainability, and
reliability, the system is decomposed into independent yet cohesive modules such as the Payment Processing Module,
Role-Based and Feature-Based Access Control (RBAC/FBAC) Module, and the Bus/Table/RSVP Sign-Up Module.\\

\noindent
Complementary documents include the System Requirement Specifications
and Module Guide.  The full documentation and implementation can be
found at \url{https://github.com/4G06-Streamliners/MacSync}.

\section{Notation}

\wss{You should describe your notation.  You can use what is below as
  a starting point.}

The structure of the MIS for modules comes from \citet{HoffmanAndStrooper1995},
with the addition that template modules have been adapted from
\cite{GhezziEtAl2003}.  The mathematical notation comes from Chapter 3 of
\citet{HoffmanAndStrooper1995}.  For instance, the symbol := is used for a
multiple assignment statement and conditional rules follow the form $(c_1
\Rightarrow r_1 | c_2 \Rightarrow r_2 | ... | c_n \Rightarrow r_n )$.

The following table summarizes the primitive data types used by \progname. 

\begin{center}
\renewcommand{\arraystretch}{1.2}
\noindent 
\begin{tabular}{l l p{7.5cm}} 
\toprule 
\textbf{Data Type} & \textbf{Notation} & \textbf{Description}\\ 
\midrule
character & char & a single symbol or digit\\
integer & $\mathbb{Z}$ & a number without a fractional component in (-$\infty$, $\infty$) \\
natural number & $\mathbb{N}$ & a number without a fractional component in [1, $\infty$) \\
real & $\mathbb{R}$ & any number in (-$\infty$, $\infty$)\\
\bottomrule
\end{tabular} 
\end{center}

\noindent
The specification of \progname \ uses some derived data types: sequences, strings, and
tuples. Sequences are lists filled with elements of the same data type. Strings
are sequences of characters. Tuples contain a list of values, potentially of
different types. In addition, \progname \ uses functions, which
are defined by the data types of their inputs and outputs. Local functions are
described by giving their type signature followed by their specification.

\section{Module Decomposition}

The following table is taken directly from the Module Guide document for this project.

\begin{table}[H]
\centering
\begin{tabular}{p{0.3\textwidth} p{0.6\textwidth}}
\toprule
\textbf{Level 1} & \textbf{Level 2}\\
\midrule

{Hardware-Hiding Module} & ~ \\
\midrule

<<<<<<< HEAD
\multirow{8}{0.3\textwidth}{Behaviour-Hiding Module} 
& Payment Processing Module\\
& RBAC/FBAC Access Control Module\\
& Sign-Up Module\\
& \hspace{1em} Sign-Up Adapter\\
& \hspace{1em} Bus Sign-Up Module\\
& \hspace{1em} Table Sign-Up Module\\
& \hspace{1em} RSVP Sign-Up Module\\
& User Authorization Module\\
=======
\multirow{7}{0.3\textwidth}{Behaviour-Hiding} & Input Parameters\\
& Output Format\\
& Output Verification\\
& Temperature ODEs\\
& Energy Equations\\ 
& Control Module\\
& Specification Parameters Module\\
>>>>>>> parent of c677736 (Updated with all modules together)
\midrule

\multirow{4}{0.3\textwidth}{Software Decision Module}
& Payment Configuration Module\\
& Access Control Module\\
& Registration Rules Module\\
& Notification Handling Module\\
\bottomrule
\end{tabular}
\caption{Module Hierarchy}
\label{TblMH}
\end{table}

\newpage
~\newpage


\newpage
\section{Module Interface Specifications} \label{SecMIS}

This section provides the Module Interface Specifications (MIS) for each module 
defined in the Module Guide. Each module is documented independently, following 
the notation and structure described in Section 2.

\subsection{MIS of Payment Processing Module (M1)} \label{MIS_M1}

\subsubsection{Module}

Payment Processing Module (M1)

This module prepares and submits payment requests from the client side.  
It validates the payment data, attaches authentication headers, and communicates 
with the backend API that integrates with Stripe. The module does not handle 
any payment verification locally. Instead, verification and 
execution of charges or refunds are performed by the backend using Stripe’s 
secure payment APIs, configured in the Payment Configuration Module (M4).

\subsubsection{Uses}

\begin{itemize}
    \item API Layer (HTTP communication with backend)
    \item User Authorization Module (M8)
    \item Payment Configuration Module (M4)
    \item Notification Handling Module (M7)
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}
N/A

\subsubsection{Exported Access Programs}

\begin{center}
\renewcommand{\arraystretch}{1.2}
\begin{tabularx}{\textwidth}{l l l X}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\midrule
submitPayment       & PaymentInfo & ConfirmationResponse & InvalidPaymentData, NetworkError \\
validatePaymentData & PaymentInfo & Boolean              & InvalidPaymentData \\
requestRefund       & RefundRequest & RefundResponse      & InvalidRefundRequest, NetworkError \\
\bottomrule
\end{tabularx}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

N/A

\subsubsection{Environment Variables}

\begin{itemize}
    \item Network connection to the backend API
    \item AuthToken from User Authorization Module (M8)
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item User must be authenticated before submitting a payment or requesting a refund.
    \item Device must have a stable network connection.
    \item The backend exposes REST endpoints:
        \begin{itemize}
            \item \texttt{POST /api/payments}: initialize Stripe PaymentIntent
            \item \texttt{POST /api/payments/refund}: request a Stripe refund
        \end{itemize}
    \item The backend manages all Stripe secret keys and secure payment operations.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \textbf{submitPayment}(paymentInfo):

\begin{itemize}
    \item transition: N/A.
    \item output: A ConfirmationResponse containing the client secret, payment result, 
    or any backend-supplied status (e.g., succeeded, failed).
    \item exception: 
        \begin{itemize}
            \item InvalidPaymentData: required fields missing or malformed  
            \item NetworkError: request fails or cannot reach backend 
        \end{itemize}
\end{itemize}

\vspace{0.2cm}

\noindent \textbf{validatePaymentData}(paymentInfo):

\begin{itemize}
    \item transition: N/A
    \item output: Returns true if all required fields (amount, event ID, billing details) 
    are correctly defined.
    \item exception: InvalidPaymentData if fields are empty or violate basic constraints.
\end{itemize}

\vspace{0.2cm}

\noindent \textbf{requestRefund}(refundRequest):

\begin{itemize}
    \item transition: N/A
    \item output: A RefundResponse containing refund status, amount refunded,  
    and backend-supplied outcome (e.g. pending, succeeded, failed).
    \item exception:
        \begin{itemize}
            \item InvalidRefundRequest: missing payment ID, invalid amount  
            \item NetworkError: unable to send or receive the refund request
        \end{itemize}
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item submitAPIRequest(jsonBody, authToken, endpoint): sends the HTTP POST request to the backend API.
    \item handleAPIResponse(response): converts backend JSON into the correct response object 
          (ConfirmationResponse or RefundResponse).
\end{itemize}

<<<<<<< HEAD
<<<<<<< HEAD
% ============================================================
% ==================== M2 START ==============================
% ============================================================

\subsection{MIS of RBAC/FBAC Access Control Module (M2)}

\subsection{MIS of Payment Processing Module (M1)} \label{MIS_M1}

\texttt{RBACModule}

Payment Processing Module (M1)

\begin{itemize}
    \item User Authorization Module (M8)
    \item Access Control Service Module (M5)
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
    \item \texttt{DEFAULT\_ROLE}: \texttt{str}\\
    Default user role when signing up for the platform.
    \item \texttt{ACCESS\_POLICY\_SCHEMA: JSON}\\
    Schema for the capability snapshot retrieved from backend M5.
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
\texttt{getUserRole} & userID: Str & role: Str & UserNotFound \\
\texttt{getUserCapabilities} & userID: Str & capabilities: list[Str] & UserNotFound \\
\texttt{authorizeAction} & action: Str & authorized: bool & AuthorizationError\\
\texttt{syncCapabilities} & userID: Str & success: bool & FetchError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item \texttt{capabilitySnapshot : dict[Str, list[Str]]}\\
    Locally cached copy of backend-authorized capabilities for the active user.
    \item \texttt{userRole: Str}\\
    UI-level role used for UX grouping.
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item \texttt{ACCESS\_CONTROL\_ENDPOINT : Str}\\
    Backend API to fetch the authoritative permissions.
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item Authorization requests are made only for defined features or actions.
    \item M5 always provides the source-of-truth permission set.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent \texttt{getUserRole(userID: Str)}:
\begin{itemize}
\item transition: None
\item input: A unique user identifier.
\item output: Returns the role string associated with the given user.
\item exception: \texttt{UserNotFound}
\end{itemize}

\noindent \texttt{getUserCapabilities(userID: Str)}:
\begin{itemize}
\item transition: None
\item input: A unique user identifier.
\item output: Returns list of available features/actions.
\item exception: \texttt{UserNotFound}
\end{itemize}

\noindent \texttt{authorizeAction(userID: Str, action: Str)}:
\begin{itemize}
\item transition: None
\item input: User ID and attempted action.
\item output: Returns \texttt{True} if permitted.
\item exception: \texttt{AuthorizationError}
\end{itemize}

\noindent \texttt{syncCapabilities(userID: Str)}:
\begin{itemize}
\item transition: Fetches capability snapshot from M5.
\item input: User ID
\item output: \texttt{True} on success.
\item exception: \texttt{FetchError}
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item None.
\end{itemize}

% ============================================================
% ==================== M3 START ==============================
% ============================================================

\subsection{MIS of Sign-Up Module (M3)}

\subsection{Module}

\wss{SignupModule}

\subsection{Uses}

\begin{itemize}
    \item A back-end or configuration service to store and retrieve confirmed signups.
    \item A front-end/UI component for users to input sign-up information.
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}
\begin{itemize}
    \item SIGNUP\_TYPES: ("RSVP", "Table", "Bus")
    \item \texttt{MAX\_PARTICIPANTS\_PER\_EVENT}: $\mathbb{N}$
\end{itemize}

\begin{itemize}
    \item \texttt{DEFAULT\_ROLE}: \texttt{str}\\
    Default user role when signing up for the platform.
    \item \texttt{ACCESS\_POLICY\_SCHEMA: JSON}\\
    Schema for the capability snapshot retrieved from backend M5.
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
submitSignup & userID: Str, eventID: Str, data: JSON & success: bool & SignupError \\
\hline
getSignupStatus & userID: Str, eventID: Str & status: JSON & NotFoundError \\
\hline
cancelSignup & userID: Str, eventID: Str & success: bool & CancellationError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item signupDetails: dict[(userID, eventID): JSON]
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item SIGNUP\_API: Str
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item User has a valid authenticated session.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent submitSignup(UserID, eventID, data):
\begin{itemize}
\item transition: Adds new signup entry.
\item output: True if successful.
\item exception: SignupError
\end{itemize}

\noindent getSignupStatus(userID, eventID):
\begin{itemize}
\item transition: None
\item output: JSON signup info.
\item exception: NotFoundError
\end{itemize}

\noindent cancelSignup(userID, eventID):
\begin{itemize}
\item transition: Removes signup entry.
\item output: True if successful.
\item exception: CancellationError
\end{itemize}

\subsubsection{Local Functions}

\noindent validateSignupData(formData: JSON):
\begin{itemize}
\item transition: None
\item output: True if valid.
\item exception: ValidationError
\end{itemize}

\noindent checkCapacity(eventID: str):
\begin{itemize}
\item transition: None
\item output: True if capacity remains.
\item exception: CapacityExceededError
\end{itemize}

% ============================================================
% ==================== M4 START ==============================
% ============================================================

\subsection{MIS of Payment Configuration Module (M4)}

\subsection{Module}

\texttt{PaymentConfigurationModule}

This module centralizes all configuration required for secure payment operations.
It exposes safe, restricted payment settings to other modules such as the Payment
Processing Module (M1) while hiding sensitive Stripe configuration logic and
backend API wiring.

\subsection{Uses}

\begin{itemize}
    \item Payment Processing Module (M1)
    \item User Authorization Module (M8)
    \item Access Control Module (M5)
    \item Notification Handling Module (M7)
    \item Backend Stripe Integration Service
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
    \item STRIPE\_PUBLIC\_KEY : Str
    \item PAYMENT\_API\_BASE : URL
    \item CURRENCY\_CODE : Str
    \item TAX\_RATE : Float
    \item INTENT\_CACHE\_TTL\_SEC : Nat
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabularx}{\textwidth}{l l l X}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\midrule
getPublicStripeKey & -- & Str & KeyNotAvailable \\
getPaymentAPIEndpoint & OperationType & URL & InvalidOperationType \\
getCurrencyConfig & -- & CurrencyConfig & -- \\
shouldRefreshPaymentIntent & LastUpdated: Time & Bool & -- \\
getReceiptConfig & -- & ReceiptConfig & -- \\
\bottomrule
\end{tabularx}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item publicKey : Str
    \item paymentAPIMap : dict[OperationType → URL]
    \item currencyConfig : CurrencyConfig
    \item receiptConfig : ReceiptConfig
    \item cacheTTL : Nat
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item ENV\_STRIPE\_PUBLIC\_KEY : Str
    \item ENV\_PAYMENT\_API\_BASE : URL
    \item SystemTime : Time
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item Stripe secret keys live only on backend.
    \item Backend exposes payment endpoints.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent getPublicStripeKey():
\begin{itemize}
\item transition: none
\item output: publicKey
\end{itemize}

\noindent getPaymentAPIEndpoint(opType):
\begin{itemize}
\item transition: none
\item output: URL for operation
\end{itemize}

\noindent getCurrencyConfig():
\begin{itemize}
\item transition: none
\item output: currencyConfig
\end{itemize}

\noindent shouldRefreshPaymentIntent(lastUpdated):
\begin{itemize}
\item transition: none
\item output: True if TTL expired
\end{itemize}

\noindent getReceiptConfig():
\begin{itemize}
\item transition: none
\item output: receiptConfig
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item loadEnvValue
    \item buildEndpoint
    \item validatePublicKey
    \item computeTTL
\end{itemize}

% ============================================================
% ==================== M5 START ==============================
% ============================================================

\subsection{MIS of Access Control Module (M5)}

\subsection{Module}

\texttt{AccessControlService}

\subsection{Uses}

\begin{itemize}
    \item Authorization Module (M8)
    \item Persistence Layer (DB)
    \item Caching Layer
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
    \item POLICY\_SCHEMA : JSON
    \item AUTH\_ERROR\_CODE : Int
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{4cm} p{4cm} p{4cm} p{4cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
checkPermission & action: Str & authorized: bool & AuthorizationError \\
assignRole & userID: Str, role: Str & success: bool & RoleError \\
revokeRole & userID: Str, role: Str & success: bool & RoleError \\
setPolicy & policy: JSON & success: bool & PolicyError\\
getPolicy & - & policy: JSON & -\\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item roleAssignments : dict[userID → set[role]]
    \item policyDocument : JSON
    \item policyVersion : Int
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item AUTH\_DB\_URI : Str
    \item CACHE\_URI : Str
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item All modules consult M5 before protected actions.
    \item M2 never bypasses M5.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent checkPermission(action):
\begin{itemize}
    \item transition: none
    \item output: True if authorized
\end{itemize}

\noindent assignRole(userID, role):
\begin{itemize}
    \item transition: adds role
    \item output: True
\end{itemize}

\noindent revokeRole(userID, role):
\begin{itemize}
    \item transition: removes role
    \item output: True
\end{itemize}

\noindent setPolicy(policy):
\begin{itemize}
    \item transition: replaces policy, increments version
    \item output: True
\end{itemize}

\noindent getPolicy():
\begin{itemize}
    \item output: policyDocument
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item None.
\end{itemize}

% ============================================================
% ==================== M6 START ==============================
% ============================================================

\subsection{MIS of Registration Rules Module (M6)} \label{MIS_M6}

\subsubsection{Module}

Registration Rules Module (M6)

This module enforces all event-level registration constraints for
Bus Sign-Up (M3.1), Table Sign-Up (M3.2), and RSVP Sign-Up (M3.3). It retrieves
event rules such as capacity limits, table constraints, bus seating limits,
registration deadlines, and RSVP policies from the backend datastore.

\subsubsection{Uses}

\begin{itemize}
    \item Access Control Module (M5)
    \item User Authorization Module (M8)
    \item Backend datastore
    \item Sign-Up Module (M3)
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

N/A

\subsubsection{Exported Access Programs}

\begin{center}
\renewcommand{\arraystretch}{1.2}
\begin{tabularx}{\textwidth}{l l l X}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\midrule
validateCapacity     & EventInfo, UserInfo & Boolean & EventFull, InvalidEvent \\
validateDeadline     & EventInfo, UserInfo & Boolean & DeadlinePassed, InvalidEvent \\
validateEligibility  & EventInfo, UserInfo & Boolean & PermissionDenied \\
getEventRules        & EventID             & EventRules & InvalidEvent \\
\bottomrule
\end{tabularx}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

None.

\subsubsection{Environment Variables}

\begin{itemize}
    \item Database connection
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item Database contains valid rules.
\end{itemize}

\subsubsection{Access Routine Semantics}

\noindent validateCapacity(eventInfo, userInfo):
\begin{itemize}
\item output: True if capacity available.
\item exception: EventFull, InvalidEvent
\end{itemize}

\noindent validateDeadline(eventInfo, userInfo):
\begin{itemize}
\item output: True if deadline not passed.
\item exception: DeadlinePassed, InvalidEvent
\end{itemize}

\noindent validateEligibility(eventInfo, userInfo):
\begin{itemize}
\item output: True if user meets criteria.
\item exception: PermissionDenied
\end{itemize}

\noindent getEventRules(eventID):
\begin{itemize}
\item output: event rules.
\item exception: InvalidEvent
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item lookupRules
    \item isBeforeDeadline
    \item hasRemainingCapacity
    \item meetsEligibilityCriteria
\end{itemize}

% ============================================================
% ==================== M7 START ==============================
% ============================================================

\subsection{MIS of Notification Handling Module (M7)}

\subsection{Module}

NotificationModule

\subsection{Uses}

\begin{itemize}
    \item Front-end notification UI
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
    \item NOTIFICATION\_TYPES: ("Confirmation", "Reminder", "Cancellation")
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\begin{tabular}{p{2cm} p{4cm} p{4cm} p{2cm}}
\hline
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\hline
SendNotification & userID: Str, message: Str, notification\_type: Str & success: bool & NotificationError \\
\hline
getNotificationHistory & userID: Str & Notifications: List[Str] & RetrievalError \\
\hline
subscribeUser & userID: Str, subscribed: bool & success: bool & SubscribingError \\
\hline
UnsubscribeUser & userID: Str, subscribed: bool & success: bool & UnsubscribingError \\
\hline
\end{tabular}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item userNotifPreference: dict[UserID: bool]
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item EMAIL\_API: Str
    \item SMS\_API: Str
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item Users opted into notifications.
\end{itemize}

\subsubsection{Access Routine Semantics}

SendNotification(userID, message, notification\_type):
\begin{itemize}
\item transition: sends notification
\item output: True if sent
\item exception: NotificationError
\end{itemize}

getNotificationHistory(userID):
\begin{itemize}
\item output: list of notifications
\item exception: RetrievalError
\end{itemize}

subscribeUser(userID, subscribed):
\begin{itemize}
\item transition: updates preference
\item output: True
\item exception: SubscribingError
\end{itemize}

UnsubscribeUser(userID, subscribed):
\begin{itemize}
\item transition: preference false
\item output: True
\item exception: UnsubscribingError
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item None
\end{itemize}

% ============================================================
% ==================== M8 START ==============================
% ============================================================

\subsection{MIS of User Authorization Module (M8)}

\subsection{Module}

\texttt{UserAuthorizationModule}

This module provides authentication and identity verification for all other
modules in the system.

\subsection{Uses}

\begin{itemize}
    \item Access Control Module (M5)
    \item Payment Processing Module (M1)
    \item Sign-Up Module (M3)
    \item Notification Handling Module (M7)
    \item External Authentication Provider
\end{itemize}

\subsection{Syntax}

\subsubsection{Exported Constants}

\begin{itemize}
    \item TOKEN\_EXPIRY\_MIN : Nat
    \item REFRESH\_TOKEN\_SUPPORTED : Bool
\end{itemize}

\subsubsection{Exported Access Programs}

\begin{center}
\renewcommand{\arraystretch}{1.2}
\begin{tabularx}{\textwidth}{l l l X}
\toprule
\textbf{Name} & \textbf{In} & \textbf{Out} & \textbf{Exceptions} \\
\midrule
login & Credentials & AuthToken & InvalidCredentials, NetworkError \\
logout & AuthToken & Bool & TokenError \\
validateToken & AuthToken & Bool & TokenExpired, TokenInvalid \\
getUserInfo & AuthToken & UserProfile & TokenInvalid, NetworkError \\
refreshToken & RefreshToken & AuthToken & TokenInvalid, NotSupported \\
\bottomrule
\end{tabularx}
\end{center}

\subsection{Semantics}

\subsubsection{State Variables}

\begin{itemize}
    \item activeSessions : dict[token → UserID]
    \item tokenExpiryTimes : dict[token → Time]
\end{itemize}

\subsubsection{Environment Variables}

\begin{itemize}
    \item AUTH\_SERVER\_URL : URL
    \item SystemTime : Time
\end{itemize}

\subsubsection{Assumptions}

\begin{itemize}
    \item All modules calling this one must supply a valid token.
    \item External auth provider is available.
\end{itemize}

\subsubsection{Access Routine Semantics}

login(credentials):
\begin{itemize}
\item transition: adds session
\item output: AuthToken
\item exception: InvalidCredentials, NetworkError
\end{itemize}

logout(token):
\begin{itemize}
\item transition: removes session
\item output: True
\item exception: TokenError
\end{itemize}

validateToken(token):
\begin{itemize}
\item output: True if valid and unexpired
\item exception: TokenExpired, TokenInvalid
\end{itemize}

getUserInfo(token):
\begin{itemize}
\item output: UserProfile
\item exception: TokenInvalid, NetworkError
\end{itemize}

refreshToken(refreshToken):
\begin{itemize}
\item transition: replaces token
\item output: new AuthToken
\item exception: TokenInvalid, NotSupported
\end{itemize}

\subsubsection{Local Functions}

\begin{itemize}
    \item decodeToken
    \item isExpired
    \item requestAuthServer
\end{itemize}

% ============================================================
% ==================== END MODULES ============================
% ============================================================

=======
>>>>>>> parent of c677736 (Updated with all modules together)
=======
>>>>>>> parent of c677736 (Updated with all modules together)
\newpage

\bibliographystyle {plainnat}
\bibliography {../../../refs/References}

\newpage

\section{Appendix} \label{Appendix}

\wss{Extra information if required}

\newpage{}

\section*{Appendix --- Reflection}

\wss{Not required for CAS 741 projects}

The information in this section will be used to evaluate the team members on the
graduate attribute of Problem Analysis and Design.

\input{../../Reflection.tex}

\subsection{Mahad Ahmed}

\begin{enumerate}
<<<<<<< HEAD
<<<<<<< HEAD
    \item What went well while writing this deliverable? 

    Something that went well while writing this deliverable was my knowledge for designing system architecture from previous courses. Specifically, 3A04 where we designed system architecture similar to this before creating our software. Using that previous knowledge really helped me complete this document.
    
    \item What pain points did you experience during this deliverable, and how
=======
=======
>>>>>>> parent of c677736 (Updated with all modules together)
  \item What went well while writing this deliverable? 
  \item What pain points did you experience during this deliverable, and how
>>>>>>> parent of c677736 (Updated with all modules together)
    did you resolve them?

    I was tasked with creating the MIS for the RBAC Module. I found it challenging due to my lack of understanding of how a RBAC/FBAC system functions, so creating the functions and design for it proved to be challenging. To resolve this, I did research on RBAC/FBAC on how they are designed and their capabilities.
    
\end{enumerate}

\subsection{Prerna Prabhu}

\begin{enumerate}
    \item What went well while writing this deliverable? 

    During this deliverable, I think we learned from our pervious deliverables and we were able to divide up tasks pretty evenly and quickly at the start based on the estimated amount of work each one would be, and we also looked at any dependencies between the different sections prior to assigning the work to each team member. In this case this meant figuring out the modules that we needed for our project, discussing them, and reviewing sections and work that were solely focused on explaining the modules, so that the other parts that depended on module definition could be completed on time without rush.

    \item What pain points did you experience during this deliverable, and how
    did you resolve them?

    During this deliverable, we initially experienced difficulties with what modules we wanted to define and how the would be defined. We were also confused as a team on what some of the requirements were for these modules and how they would be defined. Through discussion as a team, we were able to identify the modules that were needed and tweak any changes and improvements early on, without waiting until closer to the deadline. We were also able to ask more questions to our supervisor and TA to work through these challenges and gain more insight on what was expected from us.
    
\end{enumerate}

\subsection{Ali Zia}

\begin{enumerate}
    \item What went well while writing this deliverable? 

    The division of labour went really well where tasks were assigned fairly and we continued to improve in terms of communicaiton and coordinating our efforts to achieve results and complete our tasks in time

    \item What pain points did you experience during this deliverable, and how
    did you resolve them?

    A challenge we encountered was figuring out how to group the system functionaliteis into modules without overlapping responsiblites and there were moments where team members had slightly different interpretations. However, through open communication and spending time understanding our perspectives and feedback we were able to overcome and address the hallenges

\end{enumerate}

\subsection{Farhan Rahman}

\begin{enumerate}
    \item What went well while writing this deliverable? 

    Our team divided the work effectively and continued the same collaboration approach from earlier milestones, but this time we were more intentional about distributing effort based on each person’s strengths rather than just splitting sections. This helped us produce higher-quality work and kept progress steady. We also leveraged each member’s area of expertise to ensure each part was written clearly and aligned with the system’s design. 

    \item What pain points did you experience during this deliverable, and how
    did you resolve them?

    Because this deliverable involved defining key modules and system components, it took time to fine-tune the details and ensure accuracy that could be carried forward to implementation. Some sections required multiple iterations to make sure they were both technically correct and consistent with the overall system architecture. Coordinating these interdependent parts and aligning them with previous milestones was challenging, but careful reviews and group collaboration helped us resolve it.

\end{enumerate}

\subsection{Abyan Jaigirdar}

\begin{enumerate}
    \item What went well while writing this deliverable? 

    Our team worked really well together during this milestone. We divided up the sections early on and made sure everyone understood their part before starting. Communication was smooth, and we checked in often to make sure everything fit together. This helped us stay organized and finish the deliverable on time without last-minute stress.

    \item What pain points did you experience during this deliverable, and how
    did you resolve them?

    At first, we had trouble deciding how to separate the system into modules and which features belonged where. Some overlap and confusion came up during drafting, but after a few team discussions and review sessions, we cleared things up and finalized a structure we were all confident in.

\end{enumerate}

\subsection{Team}

\begin{enumerate}
  \item Which of your design decisions stemmed from speaking to your client(s)
  or a proxy (e.g. your peers, stakeholders, potential users)? For those that
  were not, why, and where did they come from?
<<<<<<< HEAD

    Several of our design decisions came from directly talking to MES executives. For example, RBAC/FBAC came from stakeholder feedback emphasizing the need for permission management across the platform. Furthermore, the integration of Stripe for payments is another design decision directly influenced by our stakeholder where they emphasized the need for secure payments. 
  
  \item While creating the design doc, what parts of your other documents (e.g.
  requirements, hazard analysis, etc), it any, needed to be changed, and why?
<<<<<<< HEAD

    While creating the design doc, multiple areas were identified where updates would be necessary. An example is in the hazard analysis such as potential authorization issues. These changes have been taken note of and will be updated in the next revision of the document.
  
  \item What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better?(LO\_ProbSolutions)

    A limitation to our solution is our dependency on external services. For example, we are depending on Stripe to have 99.99\% uptime to meet our software needs. Another dependency is using the McMaster identity platform to sign-in and authenticate users. If we had the luxury of time and resources, we would opt to create our own payment gateway that met the security concerns of our stakeholder.
  
=======
  \item What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better? (LO\_ProbSolutions)
>>>>>>> parent of c677736 (Updated with all modules together)
  \item Give a brief overview of other design solutions you considered.  What
  are the benefits and tradeoffs of those other designs compared with the chosen
  design?  From all the potential options, why did you select the documented design?
  (LO\_Explores)
<<<<<<< HEAD

    We considered many design solutions for our payment gateway such as paddle or square, but we settled with Stripe with our stakeholder for its simplicty and easy integration. We also considered many types of authentication for the platform such as creating our own authentication where users sign up and register with their own email. However, we decided to use the McMaster identity platfrom since it would be the easiest to verify users and keep users to only valid McMaster students.

  \end{enumerate}
=======
\end{enumerate}
>>>>>>> parent of c677736 (Updated with all modules together)

=======
  \item While creating the design doc, what parts of your other documents (e.g.
  requirements, hazard analysis, etc), it any, needed to be changed, and why?
  \item What are the limitations of your solution?  Put another way, given
  unlimited resources, what could you do to make the project better? (LO\_ProbSolutions)
  \item Give a brief overview of other design solutions you considered.  What
  are the benefits and tradeoffs of those other designs compared with the chosen
  design?  From all the potential options, why did you select the documented design?
  (LO\_Explores)
\end{enumerate}

>>>>>>> parent of c677736 (Updated with all modules together)

\end{document}